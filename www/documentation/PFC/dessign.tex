\chapter{Disseny e implementaci\'{o}}
\label{cha:dessign}

\section{Introduccio}
En aquest capitol veurem els patrons de dissenys emprats i les tecnologies implementades.

\section{Esquema general arquitect\'{o}nic del sistema}

\section{Patro de disseny}
Per la implementaci\`{o} del sistema web s'han usat els seg\Â¨{u}ents patrons de disseny:
  \begin{itemize}
  \item Model-Vista-Controlador amb controlador frontal
  \item Capa de Servei amb injecci\Â´{o} de depend\`{e}ncies
  \item Mapejat de dades
  \item Repositori de model de dades
  \item View template
  \item Interficies enriquides amb servei webs
  \end{itemize}

\subsection{Esquema del disseny}

\section{Implementaci\'{o} i tecnologies}
\section{Symfony}
Symfony2 \'{e}s un framework que implementa Model-Vista-Controlador amb controlador frontal amb injecci\'{o} de depencies a la capa de serveis. Les entitats(model de dades) s'han implementat directament amb l'ORM Doctrine contra una base de dades MySQL.
Arquitectonicament, Symfony2 estructura el codi en Bundle. Els "bundles" son un conjunt de serveis, entitats i recursos html independents entre si. Els bundles implementats son
\begin{itemize}
\item{Bundle de usuaris: UserBundle}
\item{Bundle de matrius: MatrixBundle}
\item{Bundle de trainings: TrainingBundle}
\item{Bundle de serveis webs: ApiBundle}
\item{Bundle de predicci\'{o}: PredictionBundle}
\end{itemize}

\section{Recursos}
La estructura de recursos \´{e}s la seg\¨{u}ent:

matrix/{id}/training

\section{Servei web}
S'ha emprat un API JSON Restful per enriquir les interficies. S'ha emprat aquesta tecnologia per la escalabilitat que aporta i perque en un futur es pogui aprofitar el desenvolupament d'aquesta.
Les operacions, els recursos i el parametres son:

season_content:
    pattern: /api/season/{id}
    requirements:
        _method: GET
        id: "\d+"

season_search_by_name:
    pattern: /api/season/searchByName
    requirements:
        _method: POST

season_set_api:
     pattern: /api/variable/{variable_id}/seasonSet/
     requirements:
         variable_id: "\d+"
         _method: GET

season_set_delete:
    pattern: /api/variable/{variable_id}/seasonSet/{seasonSet_id}
    requirements:
        _method: DELETE

season_set_component_delete:
    pattern: /api/variable/{variable_id}/seasonSet/{seasonSet_id}/component/{component_id}
    requirements:
        _method: DELETE

season_set_component_delete_complete:
    pattern: /api/variable/{variable_id}/seasonSet/{seasonSet_id}/component/{component_id}/complete
    requirements:
        _method: DELETE


matrix_column:
    pattern: /api/matrix/{matrix_id}/column/{column_id}
    requirements:
        _method: PUT
        matrix_id: "\d+"
        column_id: "\d+"

sample_update:
    pattern: /api/matrix/{matrix_id}/sample/{sample_id}
    requirements:
        _method: PUT
        matrix_id: "\d+"
        sample_id: "\d+"


\section{Capa de serveis}

\section{Integraci\'{o} amb el sistema de cues RabbitMQP}
\subsection{Introducci\'{o} a l'arquitectura de cues}
\subsection{Consumidors}
\subsubsection{Consumidor ''trainings''}
\subsubsection{Consumidor de prediccions}





