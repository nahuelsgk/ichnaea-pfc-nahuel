\chapter{Manual d'usuari}
\label{cha:userguide}

\section{Casa de l'usuari}
\label{sec:home}
Per accedir la casa de l'usuari es pot anar accedint mitjançant el logo de ''Ichnaea'' del menú situat a l'esquerra del menú. Per mirar la casa de l'usuari mirar la figura \ref{fig:dashboard}.

\begin{figure}[h!]
  \centering
  \includegraphics[scale=0.4]{img/userguide/dashboard.png}
  \caption{Interfície d'usuari: ''Casa de l'usuari''}
  \label{fig:dashboard}
\end{figure}
A continuaci\'{o} descriurem cadascuna de les parts.

\subsection{Llistat dels meus entrenaments pendents}
Al llistat superior(''My pending trainings'') pots veure els entrenaments que has creat i que estan pendents de finalitzar, on: 
\begin{itemize}
\item Nom del entrenament.
\item Nom de la matriu entrenada com a enllaç per veure la matriu.
\item Descripci\'{o} del entrenament.
\item Origen: Paràmetre de creació seleccionat per l'entrenament. Actualment solament es guarda el valor però Ichnaea no esta desenvolupat encara per executar un entrenament amb aquest paràmetre.
\item Data de creaci\'{o} de l'entrenament.
\item Nom de l'usuari que la creat(que sempre serà l'usuari registrat).
\item Progr\'{e}s: actualment Ichnaea no retorna estat del proces. Solament ens diu si ha acabat o no. Per tant els \'{u}nics valors son 0.00 i 1.00.
\item Status. Els possibles estats son ''pending''(no s'ha pogut enviar),''sent''(s'ha enviat a la cua). Els entrenaments finalitzats es poden consultar a ''Els meus entrenaments''(mirar \ref{subsec:myTrainings}).
\item Error: en cas que hi hagues algun error en el entrenament des de Ichnaea, sortiria un breu descripció.(Mirar \ref{subsec:trainingerrorsIchnaea})
\item Operacions
 \begin{itemize}
 \item \iconeyeopen es per anar a la pantalla de visualització de l'entrenament.
 \end{itemize}
\end{itemize}

\subsection{Llistat de les meves prediccions pendents}
Al llistat inferior(''My pending predictions'') pots veure les prediccions que has creat i que estan pendents de finalitzar, on: 
\begin{itemize}
\item Nom de la predicció.
\item Nom de la matriu entrenada com a enllaç per veure la matriu.
\item Descripci\'{o} del entrenament que s'esta usant en la predicció.
\item Origen: Paràmetre de creació seleccionat per l'entrenament. Actualment solament es guarda el valor pero Ichnaea no esta desenvolupat encara per executar una entrenament amb aquest paràmetre.
\item Data de creaci\'{o} de la predicció.
\item Nom de l'usuari que la creat(que sempre serà l'usuari registrat).
\item Status. Els possibles stats son ''pending''(no s'ha pogut enviar),''sent''(s'ha enviat a la cua). Els entrenaments finalitzats es poden consultar a ''Els meus entrenaments''(mirar \ref{subsec:myPrediccions}).
\item Error: en cas que hi hagués algun error en el entrenament desde Ichnaea, sortiria un breu descripcio.(Mirar \ref{subsec:trainingerrorsIchnaea})
\item Operacions
 \begin{itemize}
 \item \iconeyeopen es per anar a la pantalla de visualització de l'entrenament.
 \end{itemize}
\end{itemize}

\subsection{Els meus entrenaments}
\label{subsec:myTrainings}
Per accedir als teus entrenaments, seguir el menu ''Trainings >> My trainings''.
\begin{figure}[h!]
  \centering
  \includegraphics[scale=0.4]{img/userguide/my_trainings.png}
  \caption{Els meus entrenaments}
  \label{fig:my_trainings}
\end{figure}
On:
\begin{itemize}
\item Nom del entrenament.
\item Nom de la matriu entrenada com a enllaç per veure la matriu.
\item Descripci\'{o} del entrenament.
\item Origen: Paràmetre de creació seleccionat per l'entrenament. Actualment solament es guarda el valor pero Ichnaea no esta desenvolupat encara per executar un entrenament amb aquest paràmetre.
\item Data de creaci\'{o} de l'entrenament.
\item Nom de l'usuari que la creat(que sempre serà l'usuari registrat).
\item Progr\'{e}s: actualment Ichnaea no retorna estat del proces. Solament ens diu si ha acabat o no. Per tant els \'{u}nics valors son 0.00 i 1.00.
\item Status. Els possibles status son ''pending''(no s'ha pogut enviar),''sent''(s'ha enviat a la cua) i ''finished''(finalitzat). 
\item Operacions
 \begin{itemize}
 \item \iconeyeopen \'{e}s per anar a la pantalla de visualització de l'entrenament.
 \end{itemize}
\end{itemize}

\subsection{Les meves prediccions}
\label{subsec:myPrediccions}
Per accedir a les teves prediccions, seguir el menu ''Predictions >> My predictions''(mirar la figura \ref{fig:my_prediccions}).
\begin{figure}[h!]
  \centering
  \includegraphics[scale=0.4]{img/userguide/my_predictions.png}
  \caption{Interfície d'usuari: ''Les meves prediccions''}
  \label{fig:my_predictions}
\end{figure}
\begin{itemize}
\item Nom de la predicció.
\item Nom de la matriu entrenada com a enllaç per veure la matriu.
\item Nom de l'entrenament com a enllaç per veure quin entrenament s'esta usant per la predicció.
\item Descripció el entrenament que s'esta usant en la predicció.
\item Origen: Paràmetre de creació seleccionat per l'entrenament. Actualment solament es guarda el valor pero Ichnaea no esta desenvolupat encara per executar una entrenament amb aquest paràmetre.
\item Data de creaci\'{o} de la predicció.
\item Nom de l'usuari que la creat(que sempre serà l'usuari registrat).
\item Status. Els possibles status son ''pending''(no s'ha pogut enviar),''sent''(s'ha enviat a la cua), ''finished''(ha finalitzat) i ''new''(s'esta configurant encara la matriu de predicció).
\item Error: en cas que hi hagues algun error en el entrenament desde Ichnaea, sortiria un breu descripcio.(Mirar \ref{subsec:trainingerrorsIchnaea})
\item Operacions
 \begin{itemize}
 \item \iconeyeopen \'{e}s per anar a la pantalla de visualització de l'entrenament.
 \item \iconresults \'{e}s per consultar els resultats.
 \end{itemize}
\end{itemize}

\section{Variables}
\subsection{Veure les variables del sistema}
Desde el menu ''Ichnaea  Data - View Variables'', es poden veure totes les variables del sistema. Amb la icona \iconeyeopen, es pot accedir a la interfície de configuraci\'{o} de la variable seleccionada.

\subsection{Formulari de edici\'{o} d'una variable}
\begin{figure}[h!]
  \centering
  \includegraphics[scale=0.5]{img/userguide/variable_configuration.png}
  \caption{Configuraci\'{o} de variable}
  \label{fig:placement}
\end{figure}
\subsection*{Informació bàsica}
L' ID \'{e}s l'identificador d'Ichnaea i la descripció \'{e}s un camp modificable per descriure la variable.
\subsection{Llistat de conjunts de fitxers}
A l'apartat ''List of season set'' es veuen els conjunts de fitxers amb el seus components d'aquesta variable on:
\begin{itemize}
\item \iconedit per modificar el conjunt de fitxers(nom, components i configuracions).
\item \icontrash per esborrar tot el conjunt i tots el fitxers associats, excepte els compartits(simplement esborra la associació).
\item \iconadd per afegir un conjunt nou de fitxers
\end{itemize}

\subsection{Formulari de creació i d'actualització d'un conjunt de fitxers(''Season set'')}
A la figura \ref{fig:seasonSetEdition} es pot veure aquest formulari.
\label{season_set:variable}
\begin{figure}[h!]
  \centering
  \includegraphics[scale=0.5]{img/userguide/season_set_edition.png}
  \caption{Configuraci\'{o} de conjunts de fitxers d'una variable}
  \label{fig:seasonSetEdition}
\end{figure}
A continuació es descriuen les funcionalitats d'aquest formulari.

\subsubsection{Afegir nous fitxers a un conjunt de fitxers}
A l'apartat \textbf{''Add new seasons to this season set''}, \'{e}s pot afegir nous fitxers amb un navegador de fitxer accedint a ''Navega...''. \\

El selector de temporades es per configurar el fitxer com estiu, hivern, tardor, primavera o com a tot l'any.\\

El tercer camp \'{e}s un camp especial de tipus ''sols lectura'' per comprovar que el fitxer es carrega be.

\subsubsection{Afegir un fitxer d'una altre variable}
En el cas de que existeixin variables que tinguin envelliments similars, es pot buscar a la secció ''Add shared seasons''.\\

\'{E}s un camp de tipus auto-completat que desplega un menú per que l'usuari seleccioni el que busca. Amb el següent selector el pot configurar. L'ultim camp es per comprovar que el fitxer es carrega be.

\subsubsection{Esborrar un fitxer del conjunt de fitxers}
Amb la icona \icontrash pots esborrar el fitxer i el seu contingut d'aquest conjunt de fitxers.\\
Amb la icona \iconremove pots esborrar el fitxer com a component. Per exemple, si has afegit un fitxer compartit, no esborres el fitxer sinó que simplement deixa de estar associat a aquest conjunt de fitxers.

\section{Matrius}

\subsection{Crear una matriu desde un fitxer csv o excel}
\label{sec:create_matrix}
Desde el menu superior ''IchnaeaData - New matrix'', es pot pujat una nova matriu en format csv o Microsoft Excel.El format csv es compatible amb les programaris de ofim\`{a}tica m\'{e}s habituals como Microsoft Excel o Libreoffice.

El format de la matriu \'{e}s com es mostra a la figura \ref{matrixSource}
\begin{figure}[h!]
  \centering
  \includegraphics[scale=0.5]{img/userguide/matrix_source.png}
  \caption{Fulla de calcul d'exemple}
  \label{fig:matrixSource}
\end{figure}

\begin{itemize}
\item Primera columna. Son els identificadors de la variable. Si una columna es diu igual que una variable del sistema, automàticament s'assigna a aquesta.
\item Les ultimes dues columnes son especials i son opcionals. Es contemplen totes les casuístiques:
\begin{itemize}
\item No existeixen
\item Solament ORIGIN
\item Solament DATE
\item Primer ORIGIN i després DATE
\item Primer DATE i després ORIGIN
\end{itemize}
\item La columna ORIGIN explicita l'origen de les mostres. En el cas que no sigui present, cada mostra s'intentar\`{a} resoldre  amb un associació segons sub-cadenes:
\begin{itemize}
\item Si el identificador de la mostra conte HM es resoldrà com HUMAN.
\item Si el identificador de la mostra conte PG es resoldrà com PIG.
\item Si el identificador de la mostra conte PL es resoldrà com POULTRY.
\item Si el identificador de la mostra conte CW es resoldrà com COW
\end{itemize}
\item La columna DATE explicita les dates de les mostres amb el format DD/MM/YYYY.
\end{itemize}

El resultat d'aquest exemple es pot veure a la figura \ref{fig:matrixResulting}:
\begin{figure}[h!]
  \centering
  \includegraphics[scale=0.3]{img/userguide/matrix_resulting.png}
  \caption{Resultat de la fulla d'exemple}
  \label{fig:matrixResulting}
\end{figure}

\subsection{Interfície de configuració d'una matriu}
\label{subsec:interfaceConfiguration}
A la figura \ref{fig:configure_matrix} es pot veure la interfície de configuració de les matrius.
\begin{figure}[h!]
  \centering
  \includegraphics[scale=0.2]{img/userguide/matrix_configure.png}
  \caption{Interfície de configuraci\'{o} de matrius}
  \label{fig:configure_matrix}
\end{figure}

\textbf{Solament l'usuari propietari de la matriu la pot configurar}. A continuació descrivim les seccions de la interfície.
\begin{itemize}
\item Configuració bàsica
\item Missatges
\item Accions
\item Dades de Matrius
\end{itemize}

\subsubsection{Configuració bàsica}
La visibilitat \'{e}s un paràmetre per permetre que altres usuaris vegin la matriu per entrenar-la.

\subsubsection{Missatges} 
Apartat on el sistema comunica a l'usuari errors de validacions i perills.

\subsubsection{Accions} 
Les accions disponibles son:
\begin{itemize} 
\item \icondownload per descarregar-se la matriu en CSV.
\item \iconupdate per actualitzar les dades, no la configuració.
\item \icontrash per esborrar la matriu, els entrenaments i les prediccions
\item \icontraining per crear un entrenament amb aquesta matriu
\item But\'{o} ''Validate'': valida la matriu. Sortiran a la secció de missatges els possibles errors.
\end{itemize}

\subsubsection{Configuració de les dades de la matriu}
\paragraph*{Columnes} Les columnes es per configurar les variables de la matriu on:
\begin{itemize}
\item \iconalias es per definir el alies de la columna
\item \iconvariable es per seleccionar una variable. Si no es selecciona res, quedara configurada com una variable derivada.
\item \iconseason en cas de seleccionar una variable, es carregaran els conjunts de fitxers de la variable.
\end{itemize}
Una vegada actualitzat les dades en alguna columna, apareixerà la icona \iconedit per salvar les dades. En el cas que hagi diferents columnes configurades, es podrà pitjar el buto ''Save all changes''.

\paragraph*{Actualitzar una mostra} Per actualitzar una mostra:
\begin{itemize}
\item El primer camp es l'alies de la mostra
\item El segon es un calendari per seleccionar una data
\item El tercer es un camp auto completat optatiu. Quan es comença a escriure, surt un desplegable per seleccionar un dels possibles valors dels orígens que existeixen a la matriu o escriure un nou.
\end{itemize}

\paragraph*{Actualitzar una dada d'una fila i d'una columna} Es poden actualitzar les dades d'una mostra fent un doble ''click'' en una de les celles. Prement ''Enter'' es guarda el resultat.


\subsection{Clonar una matriu}
\label{subsec:clone_matrix}
L'objectiu de clonar una matriu es per tenir matrius similars però per canviar de configuracions. L'objectiu de canviar de configuració es crear entrenaments amb altres configuracions(altres conjunts de fitxers per variable, o modificar un origen , etc). No es copien ni els entrenaments ni les prediccions. Una matriu entrenada no es pot canviar la configuració.\\

Per clonar una matriu, seguir el menú ''Ichnaea Data - View Matrix'', podem accedir al llistat de variables del sistema; amb la icona \iconclone accedim al formulari de clonaci\'{o}(figura \ref{fig:cloneMatrix}). 
\begin{figure}[h!]
  \centering
  \includegraphics[scale=0.2]{img/userguide/clone_matrix}
  \caption{Interfici d'usuari ''Clonar una matriu''}
  \label{fig:cloneMatrix}
\end{figure}
El formulari suggereix un nom que es pot canviar. Si l'usuari accepta la clonaci\'{o} l'usuari clona les dades i la configuraci\'{o} i es dirigir\`{a} a la la interfície de configuració.


\section{Entrenaments}
\subsection{Crear un entrenament d'una matriu}
\label{subsec:createtraining}
Per crear un entrenament primerament s'ha de seleccionar un matriu. Per crear un entrenament existeixen diferents formes:
\begin{itemize} 
\item Opció 1) Des de el llistat de matrius entrenables(''Ichnaea Data >> Create training'') amb la icona \icontraining.
\item Opció 2) Visualitzant una matriu accedint des de el llistat de matrius del sistema: ''Ichnaea Data >> View matrixs >> \iconeyeopen >> \icontraining.
\item Opcio 3) Des de la interfície de configuració de la matriu(mirar la secció \ref{subsec:interfaceConfiguration}).
\end{itemize}

La figura \ref{fig:createTraining} \'{e}s la interfície de creació d'entrenaments on:
\begin{figure}[h!]
  \centering
  \includegraphics[scale=0.4]{img/userguide/training_create.png}
  \caption{Llistat de matrius}
  \label{fig:createTraining}
\end{figure}
\begin{itemize}
\item Part esquerra superior: nom i descripci\'{o} de l'entrenament.
\item Part dreta superior: Desplegable per seleccionar un dels orígens disponibles.  El ''origen-versus'', es un llistat de la variable origen de la matriu. Si es selecciona el valor "All versus all", l'entrenament ser\'{a} tots contra tots. Si \'{e}s selecciona un origen concret, l'entrenament es far\`{a} aquest origen contra els altres. \textbf{Actualment Ichnaea no suporta aquesta part per\'{o} en el futur est\`{a} planificat que ho far\`{a}}.
\item Selecci\'{o} de columnes. Selecci\'{o} de columnes que vols entrenar.
\end{itemize}

Si la creaci\´{o} \´e{s} correcte, les dades s'enviaran a la cua de procesos i la aplicaci\´{o} es redirigir\´{a} la pantalla de visualitzaci\´{o} de entrenaments(mirar la secció \ref{subsec:viewtraining}).

\subsection{Visualitzar un entrenament}
\label{subsec:viewtraining}
Des de la casa de l'usuari(mirar \ref{sec:home}), es pot veure els teus entrenaments pendents i en quin estadi es troben. Per els finalitzats, es poden accedir des de ''Els meus entrenaments''(secció \ref{subsec:myTrainings}).

La figura \ref{fig:viewTraining} es la interfícies que mostra un entrenament on:

\begin{figure}[h!]
  \centering
  \includegraphics[scale=0.5]{img/userguide/view_training_pending.png}
  \caption{Interfície de visualització de entrenaments}
  \label{fig:viewTraining}
\end{figure}
\begin{itemize}
\item Títol: nom de l'entrenament, data de creació i propietari.
\item Configuracio: 
\begin{itemize}
\item Nom de la matriu com enllaç
\item Nom de l'entrenament
\item Origin-versus seleccionat(veure \ref{subsec:createtraining}).
\item \textbf{Cue id}: identificador del proces a la cua.
\end{itemize}
\item Columnes seleccionades per entrenar
\item Resultat: es una barra de progressió. Actualment Ichnaea no ens retorna estats parcial. Així que la barra estarà buida o plena.
\item Errors: errors capturats d'Ichnaea.
\item Prediccions: prediccions fetes amb aquest entrenament. Amb la icona \iconadd es pot crear una predicció usant aquest entrenament.
\end{itemize}

\section{Prediccions}
\subsection{Crear un entrenament d'una matriu}
Per crear una matriu de prediccions, primer s'ha de seleccionar un entrenament. Per seleccionar un entrenament i crear una predicció tenim X opcions:
\begin{itemize}
\item Opció a) Seguir el menú ''Trainings'' >> ''Create trainings'' >> Seleccionar un entrenament amb \icontableninesquares
\item Opcio b) Des de la interfície de visualitzacions d'entrenaments(mirar \ref{subsec:viewtraining}).
\end{itemize}

\section{Problemes de Ichnaea}
\label{sec:ichnaeaErrors}
\subsection{Error en els entrenaments}

Actualment Ichnaea Software i el sistema de cues no esta implantat. Per defecte, la creaci\'{o} donar\'{a} error. Per tant, es pot utilitzar la simulaci\'{o} de trainings.
A banda d'aix\'{o}, tenim predifinits un conjunt de situacions que a continuaci\'{o} descrivim.

\section{Crear una matriu de predicci\'{o}}
Desde la casa de l'usuari, es pot veure els teus trainings i en quin estadi es troben. Amb la icona "Quadradets"

\section{Crear una predicci\'{o}}
Desde la casa de l'usuari(mirar \ref{sec:home}) es pot crear una predicci\'{o} d'un training. Seleccionant la icona ''quadricules'' de un trainig correcte(en color verd), es pot crear un matriu de predicci\'{o}.

\begin{figure}[h!]
  \centering
  \includegraphics[scale=0.2]{img/userguide/prediction_create.png}
  \caption{Exemple de creaci\'{o} de predicci\'{o}}
  \label{fig:placement}
\end{figure}

A part superior \'{e}s pot seleccionar un fitxer per pujar la matriu per predir. A la part inferior es pot veure les columnes que el training t\'{e} seleccionades. La matrius en format csv ha de tenir el format indicat per la part inferior. En breu es podr\'{a} descarregar una template per tenir el template i poder simplement omplir els valors:
\begin{center}
    \begin{tabular}{ | l | l | l | p{5cm} |}
    \hline
    Cel.la buida & Alias de la columna & .... & ORIGIN \\ \hline
    Nom de la sample & Valor de la sample  & .... & Origen de la sample \\ \hline
    S01-10-20        & 0,000145            & .... & Human \\ \hline
    \hline
    \end{tabular}
\end{center}
Seguidament es pot visualitzar

\section{Actualitzar una matriu de predicci\'{o}}

\section{Llistar les meves prediccions}
Desde el menu superior "Prediction - My predictions" pots llistar les teves prediccions.

\section{Visualitzar una matriu de predicci\'{o}}

\subsection{Actualitzar una matriu de predicci\'{o}}

\subsection{Executar una predicci\'{o} de una matriu de predicci\'{o}}


